import pytest
import re
import rivet.rivet as rivet
from mem_lexicon.lexicon import Lexicon


def test_rivet():
    test_text_1 = "Postmodernist nihilism, Foucaultist power relations and libertarianism\nG. Andreas Reicher\n\nDepartment of Deconstruction, University of Massachusetts, Amherst\nBarbara Bailey\n\nDepartment of Gender Politics, Oxford University\n\n1. Subdialectic cultural theory and the textual paradigm of consensus\n\nThe main theme of the works of Spelling is the common ground between class\nand truth. An abundance of deconstructions concerning the role of the\nparticipant as observer exist. However, the primary theme of Scuglia’s[1] analysis of the textual paradigm of consensus is the\ndifference between sexual identity and narrativity.\n\n“Sexual identity is part of the genre of truth,” says Bataille. Derrida uses\nthe term ‘postmodernist nihilism’ to denote a self-fulfilling totality.\nTherefore, the premise of the textual paradigm of consensus implies that\nnarrative must come from the collective unconscious.\n\n“Culture is fundamentally impossible,” says Foucault; however, according to\nPrinn[2] , it is not so much culture that is fundamentally\nimpossible, but rather the defining characteristic, and eventually the\ndialectic, of culture. Sontag uses the term ‘postmaterial narrative’ to denote\nthe role of the reader as observer. Thus, the subject is contextualised into a\npostmodernist nihilism that includes sexuality as a paradox.\n\nHanfkopf[3] states that we have to choose between\nprecapitalist theory and textual Marxism. But Marx uses the term ‘subdialectic\ncultural theory’ to denote the failure, and therefore the defining\ncharacteristic, of submodern consciousness.\n\nIf the textual paradigm of consensus holds, we have to choose between\nFoucaultist power relations and cultural postdialectic theory. Thus, the\nsubject is interpolated into a postmodernist nihilism that includes art as a\nreality.\n\nWerther[4] suggests that the works of Stone are not\npostmodern. However, several theories concerning Lacanist obscurity may be\nfound.\n\nIf subdialectic cultural theory holds, we have to choose between the textual\nparadigm of consensus and pretextual cultural theory. In a sense, the main\ntheme of the works of Stone is a neotextual totality.\n2. Stone and the conceptual paradigm of narrative\n\n“Class is part of the dialectic of culture,” says Bataille. Lacan’s essay on\nthe textual paradigm of consensus states that the State is elitist, but only if\nLyotardist narrative is invalid; otherwise, we can assume that society has\nintrinsic meaning. It could be said that the subject is contextualised into a\nsubdialectic cultural theory that includes truth as a paradox.\n\nThe primary theme of Sargeant’s[5] critique of the\ntextual paradigm of consensus is the absurdity, and subsequent collapse, of\ncultural class. Any number of discourses concerning the role of the artist as\nreader exist. However, Dahmus[6] holds that we have to\nchoose between postmodernist nihilism and premodern deconstruction.\n\nIf one examines subdialectic cultural theory, one is faced with a choice:\neither reject the textual paradigm of consensus or conclude that sexuality is\ncapable of significance. The subject is interpolated into a postmodernist\nnihilism that includes narrativity as a reality. Therefore, the main theme of\nthe works of Spelling is a mythopoetical whole.\n\nIn the works of Spelling, a predominant concept is the distinction between\ncreation and destruction. Baudrillard uses the term ‘subdialectic cultural\ntheory’ to denote the meaninglessness, and hence the absurdity, of dialectic\nsociety. But Sartre’s model of postmodernist nihilism suggests that academe is\npart of the collapse of consciousness.\n\n“Sexual identity is meaningless,” says Foucault. Lyotard uses the term ‘the\ntextual paradigm of consensus’ to denote the role of the observer as artist.\nTherefore, a number of narratives concerning the neocultural paradigm of\ncontext may be discovered.\n\nIn the works of Spelling, a predominant concept is the concept of textual\nnarrativity. Sontag uses the term ‘postmodernist nihilism’ to denote the\nabsurdity, and eventually the collapse, of predeconstructive class. However,\nFoucault promotes the use of the textual paradigm of consensus to modify and\ndeconstruct consciousness.\n\nSartre uses the term ‘subdialectic cultural theory’ to denote the bridge\nbetween society and narrativity. But Bataille suggests the use of the textual\nparadigm of consensus to challenge the status quo.\n\nAny number of discourses concerning a self-referential totality exist. Thus,\nif subdialectic cultural theory holds, we have to choose between the textual\nparadigm of consensus and cultural libertarianism.\n\nIn Beverly Hills 90210, Spelling deconstructs postmodernist nihilism;\nin Charmed he analyses the postcapitalist paradigm of consensus. It\ncould be said that postmodernist nihilism implies that the significance of the\nwriter is deconstruction, given that art is equal to consciousness.\n\nSartre promotes the use of subdialectic cultural theory to modify society.\nBut Marx’s critique of postmodernist nihilism suggests that culture is capable\nof truth.\n\nCameron[7] states that we have to choose between the\ntextual paradigm of consensus and Foucaultist power relations. Therefore,\npostmodernist nihilism holds that class, ironically, has significance.\n\nThe within/without distinction prevalent in Spelling’s Robin’s Hoods\nemerges again in Melrose Place, although in a more semantic sense. Thus,\nSontag’s model of subcultural sublimation suggests that language serves to\nmarginalize the proletariat.\n\nIf subdialectic cultural theory holds, the works of Spelling are postmodern.\nHowever, the primary theme of Humphrey’s[8] essay on the\ntextual paradigm of consensus is the role of the reader as participant.\n\nThe subject is contextualised into a postdialectic narrative that includes\nreality as a reality. It could be said that Sartre suggests the use of\npostmodernist nihilism to deconstruct capitalism.\n3. Contexts of failure\n\n“Sexual identity is part of the economy of narrativity,” says Lacan. The\nmain theme of the works of Spelling is the stasis of textual consciousness. In\na sense, Hamburger[9] holds that we have to choose between\npostmaterial cultural theory and Batailleist `powerful communication’.\n\n“Sexual identity is intrinsically a legal fiction,” says Debord; however,\naccording to Scuglia[10] , it is not so much sexual\nidentity that is intrinsically a legal fiction, but rather the rubicon, and\nsubsequent defining characteristic, of sexual identity. The premise of\nsubdialectic cultural theory implies that the Constitution is capable of social\ncomment, given that the textual paradigm of consensus is valid. Thus, in\nBeverly Hills 90210, Spelling denies postmodernist nihilism; in\nRobin’s Hoods, however, he reiterates subdialectic cultural theory.\n\n“Class is meaningless,” says Bataille. The subject is interpolated into a\npostmodernist nihilism that includes truth as a totality. It could be said that\nDerrida uses the term ‘Foucaultist power relations’ to denote the role of the\npoet as writer.\n\nIn the works of Spelling, a predominant concept is the distinction between\nfeminine and masculine. If postmodernist nihilism holds, we have to choose\nbetween subdialectic cultural theory and cultural narrative. But Sontag\npromotes the use of Derridaist reading to attack and modify sexuality.\n\n“Society is part of the futility of consciousness,” says Debord; however,\naccording to Prinn[11] , it is not so much society that is\npart of the futility of consciousness, but rather the rubicon, and eventually\nthe fatal flaw, of society. Many discourses concerning postmodernist nihilism\nmay be found. Therefore, Sontag suggests the use of subdialectic cultural\ntheory to challenge outmoded, colonialist perceptions of sexual identity.\n\nThe characteristic theme of la Tournier’s[12] critique\nof the textual paradigm of consensus is the futility, and subsequent absurdity,\nof textual society. However, Bataille uses the term ‘subcapitalist\nappropriation’ to denote a self-falsifying whole.\n\nThe main theme of the works of Spelling is not desublimation, but\nneodesublimation. Thus, a number of materialisms concerning the failure, and\neventually the rubicon, of dialectic sexual identity exist.\n\nScuglia[13] holds that we have to choose between\nsubdialectic cultural theory and constructivist deconstruction. However, if\npostmodernist nihilism holds, the works of Burroughs are empowering.\n\nFoucault uses the term ‘neocapitalist semiotic theory’ to denote not\nnarrative, but postnarrative. In a sense, the primary theme of Long’s[14] essay on postmodernist nihilism is the collapse, and\ntherefore the dialectic, of modern art.\n\nMarx promotes the use of the textual paradigm of consensus to read class.\nBut the subject is contextualised into a subdialectic cultural theory that\nincludes narrativity as a paradox.\n\nSontag suggests the use of postmodernist nihilism to attack class divisions.\nIt could be said that Lacan uses the term ‘subdialectic cultural theory’ to\ndenote not, in fact, discourse, but prediscourse.\n\nIn Nova Express, Burroughs examines postmodernist nihilism; in\nJunky, although, he denies subcapitalist sublimation. Therefore, any\nnumber of narratives concerning postmodernist nihilism may be revealed."
    test_text_2 = "The Expression of Defining characteristic: Postconstructivist theory and\nFoucaultist power relations\nJane K. E. Tilton\n\nDepartment of Semiotics, University of Massachusetts, Amherst\n\n1. Capitalist narrative and neosemantic discourse\n\nThe characteristic theme of the works of Joyce is the futility, and\nsubsequent defining characteristic, of dialectic sexual identity. The main\ntheme of Pickett’s[1] critique of neosemantic discourse is a\nmythopoetical reality. But Sartreist existentialism suggests that reality may\nbe used to entrench capitalism.\n\nSeveral theories concerning neosemantic discourse exist. It could be said\nthat la Fournier[2] implies that we have to choose between\nconstructivist deappropriation and Sontagist camp.\n\nIn Ulysses, Joyce examines neosemantic discourse; in\nDubliners, although, he denies subtextual theory. In a sense, the\nsubject is interpolated into a Foucaultist power relations that includes art as\na paradox.\n\nThe primary theme of the works of Joyce is the bridge between sexuality and\nsociety. Therefore, the premise of postconstructivist theory states that\ncontext must come from the collective unconscious.\n2. Realities of futility\n\nIf one examines dialectic libertarianism, one is faced with a choice: either\nreject Foucaultist power relations or conclude that the goal of the poet is\nsocial comment. Lacan uses the term ‘Debordist image’ to denote a\npredeconstructivist reality. However, if postconstructivist theory holds, we\nhave to choose between textual rationalism and Foucaultist power relations.\n\nIn the works of Joyce, a predominant concept is the distinction between\nfeminine and masculine. The main theme of Finnis’s[3] essay\non postconstructivist theory is the difference between sexual identity and\nclass. Thus, Sartre uses the term ‘Foucaultist power relations’ to denote a\nself-justifying paradox.\n\n“Art is intrinsically used in the service of class divisions,” says Debord;\nhowever, according to Long[4] , it is not so much art that\nis intrinsically used in the service of class divisions, but rather the stasis,\nand thus the defining characteristic, of art. Brophy[5]\nsuggests that the works of Joyce are an example of mythopoetical rationalism.\nIn a sense, Sontag promotes the use of neosemantic discourse to deconstruct and\nmodify sexual identity.\n\nIn the works of Joyce, a predominant concept is the concept of cultural\nculture. Sartre uses the term ‘postmaterialist theory’ to denote the failure,\nand some would say the stasis, of cultural class. Thus, any number of\ndiscourses concerning not, in fact, dematerialism, but predematerialism may be\nfound.\n\nIf one examines postconstructivist theory, one is faced with a choice:\neither accept neosemantic discourse or conclude that reality is a legal\nfiction, but only if neocapitalist narrative is invalid; if that is not the\ncase, Debord’s model of postconstructivist theory is one of “dialectic\nsubcultural theory”, and hence fundamentally responsible for outmoded\nperceptions of sexual identity. The primary theme of the works of Joyce is the\ndefining characteristic, and therefore the failure, of dialectic class.\nHowever, the fatal flaw of Lyotardist narrative intrinsic to Joyce’s\nFinnegan’s Wake is also evident in A Portrait of the Artist As a\nYoung Man.\n\nMarx suggests the use of postconstructivist theory to challenge class\ndivisions. In a sense, the main theme of Hamburger’s[6]\nmodel of Foucaultist power relations is the role of the observer as poet.\n\nThe premise of neosemantic discourse holds that truth is used to marginalize\nthe underprivileged. However, the subject is contextualised into a\npostconstructivist theory that includes consciousness as a totality.\n\nIn Ulysses, Joyce affirms Foucaultist power relations; in\nDubliners, however, he analyses textual objectivism. In a sense,\nDebord’s essay on Foucaultist power relations states that expression is a\nproduct of the masses.\n\nThe characteristic theme of the works of Joyce is the bridge between society\nand class. However, the premise of postconstructivist theory implies that\nsexuality, somewhat paradoxically, has objective value.\n\nAn abundance of desituationisms concerning Foucaultist power relations\nexist. Therefore, Foucault uses the term ‘neosemantic discourse’ to denote the\nrole of the participant as reader.\n\nThe subject is interpolated into a postconstructivist theory that includes\nnarrativity as a reality. But the within/without distinction depicted in\nJoyce’s A Portrait of the Artist As a Young Man emerges again in\nDubliners, although in a more self-fulfilling sense.\n\nMarx uses the term ‘neocultural textual theory’ to denote the difference\nbetween class and language. It could be said that the primary theme of\nHumphrey’s[7] critique of Foucaultist power relations is not\ndiscourse, as Sartre would have it, but postdiscourse.\n3. Postconstructivist theory and the subdeconstructive paradigm of\nreality\n\n“Class is meaningless,” says Bataille; however, according to Parry[8] , it is not so much class that is meaningless, but rather\nthe dialectic, and some would say the stasis, of class. Lacan uses the term\n‘Marxist capitalism’ to denote the genre, and subsequent failure, of cultural\nculture. Thus, a number of narratives concerning a mythopoetical whole may be\nrevealed.\n\nIn the works of Tarantino, a predominant concept is the distinction between\nopening and closing. If Foucaultist power relations holds, the works of\nTarantino are modernistic. However, Foucault uses the term ‘postconstructivist\ntheory’ to denote not dematerialism, but postdematerialism.\n\nThe subject is contextualised into a subdialectic discourse that includes\nart as a reality. In a sense, many situationisms concerning the\nsubdeconstructive paradigm of reality exist.\n\nWilson[9] holds that we have to choose between capitalist\nneodialectic theory and cultural feminism. Thus, the subdeconstructive paradigm\nof reality suggests that the purpose of the poet is significant form, given\nthat language is interchangeable with art.\n\nThe example of preconceptualist theory prevalent in Rushdie’s The Moor’s\nLast Sigh is also evident in Satanic Verses. But Marx’s analysis of\npostconstructivist theory holds that society has intrinsic meaning.\n4. Rushdie and Foucaultist power relations\n\nIf one examines dialectic objectivism, one is faced with a choice: either\nreject postconstructivist theory or conclude that the raison d’etre of the\nartist is deconstruction. An abundance of discourses concerning the common\nground between narrativity and class may be discovered. It could be said that\nthe premise of the subdeconstructive paradigm of reality suggests that reality\nis created by the collective unconscious.\n\n“Sexual identity is intrinsically impossible,” says Debord; however,\naccording to Geoffrey[10] , it is not so much sexual\nidentity that is intrinsically impossible, but rather the dialectic, and hence\nthe fatal flaw, of sexual identity. The subject is interpolated into a\npostconstructivist theory that includes consciousness as a paradox. In a sense,\nDerrida promotes the use of the subdeconstructive paradigm of reality to\nanalyse class.\n\nAny number of destructuralisms concerning Foucaultist power relations exist.\nHowever, Baudrillard uses the term ‘postconstructivist theory’ to denote not\ntheory, but posttheory.\n\nMarx’s critique of the subdeconstructive paradigm of reality states that the\nConstitution is a legal fiction, given that Sartreist absurdity is valid. Thus,\nBaudrillard suggests the use of postconstructivist theory to deconstruct\nsexism.\n\nFoucault’s essay on Foucaultist power relations suggests that culture may be\nused to reinforce hierarchy. It could be said that the main theme of the works\nof Stone is the bridge between sexual identity and society.\n\nBaudrillard uses the term ‘pretextual construction’ to denote the role of\nthe writer as reader. But several desituationisms concerning the defining\ncharacteristic, and some would say the dialectic, of capitalist class may be\nrevealed.\n5. Discourses of collapse\n\nThe primary theme of la Fournier’s[11] analysis of\npostconstructivist theory is the role of the participant as reader. The subject\nis contextualised into a Foucaultist power relations that includes language as\na whole. In a sense, if the subdeconstructive paradigm of reality holds, we\nhave to choose between postconstructivist theory and neodeconstructivist\nsemantic theory.\n\n“Society is part of the genre of narrativity,” says Marx; however, according\nto Pickett[12] , it is not so much society that is part of\nthe genre of narrativity, but rather the failure, and subsequent collapse, of\nsociety. In JFK, Stone denies the subdeconstructive paradigm of reality;\nin Heaven and Earth he examines Foucaultist power relations. However,\nSartre promotes the use of postconstructivist theory to modify and challenge\nsexual identity.\n\nThe defining characteristic, and therefore the genre, of Foucaultist power\nrelations intrinsic to Stone’s Platoon emerges again in Natural Born\nKillers, although in a more modern sense. Therefore, the premise of the\nsubdeconstructive paradigm of reality states that narrative must come from the\nmasses.\n\nHubbard[13] implies that the works of Stone are\nreminiscent of Madonna. It could be said that Lyotard uses the term ‘Debordist\nsituation’ to denote the collapse of neopatriarchialist consciousness.\n\nMarx suggests the use of postconstructivist theory to attack sexism. Thus,\nFoucaultist power relations holds that society, perhaps ironically, has\nobjective value.\n\nBaudrillard promotes the use of the subdeconstructive paradigm of reality to\nread sexual identity. However, the premise of dialectic precultural theory\nstates that truth serves to disempower the Other, but only if art is equal to\nlanguage; otherwise, we can assume that sexuality is responsible for\ncapitalism.\n6. Foucaultist power relations and dialectic narrative\n\nThe characteristic theme of the works of Stone is the difference between\nsociety and sexual identity. The figure/ground distinction depicted in Stone’s\nJFK is also evident in Natural Born Killers. It could be said\nthat the main theme of Brophy’s[14] essay on the\npostcultural paradigm of reality is not, in fact, materialism, but\nneomaterialism.\n\nIn the works of Stone, a predominant concept is the concept of capitalist\nart. The subject is interpolated into a postconstructivist theory that includes\nculture as a totality. In a sense, the primary theme of the works of Stone is\nthe bridge between reality and sexual identity.\n\n“Consciousness is part of the fatal flaw of narrativity,” says Marx. Debord\nuses the term ‘Foucaultist power relations’ to denote not narrative as such,\nbut subnarrative. It could be said that the characteristic theme of Wilson’s[15] model of postconstructivist theory is the common ground\nbetween society and class.\n\nIf Foucaultist power relations holds, we have to choose between the\ncapitalist paradigm of context and postpatriarchial desituationism. But the\nsubject is contextualised into a postconstructivist theory that includes\nsexuality as a reality.\n\nLyotard suggests the use of Foucaultist power relations to challenge the\nstatus quo. However, Dahmus[16] implies that we have to\nchoose between postconstructivist theory and subconceptual textual theory.\n\nThe primary theme of the works of Stone is the genre, and some would say the\nrubicon, of precultural sexual identity. But Marx’s essay on Foucaultist power\nrelations holds that discourse is a product of the collective unconscious,\ngiven that dialectic socialism is invalid.\n\nThe characteristic theme of Cameron’s[17] analysis of\ndialectic narrative is the bridge between class and society. In a sense, in\nHeaven and Earth, Stone analyses Foucaultist power relations; in\nJFK, however, he denies postconstructivist theory.\n7. Narratives of absurdity\n\n“Culture is a legal fiction,” says Sontag; however, according to Tilton[18] , it is not so much culture that is a legal fiction, but\nrather the economy, and thus the paradigm, of culture. The subject is\ninterpolated into a dialectic neoconceptualist theory that includes reality as\na paradox. Therefore, Bataille uses the term ‘Foucaultist power relations’ to\ndenote not narrative, but postnarrative.\n\n“Class is fundamentally used in the service of class divisions,” says\nSartre. The subject is contextualised into a textual nationalism that includes\nconsciousness as a reality. Thus, the futility of Foucaultist power relations\nintrinsic to Stone’s Natural Born Killers emerges again in Heaven and\nEarth, although in a more mythopoetical sense.\n\nBaudrillard uses the term ‘subconstructive cultural theory’ to denote a\npredialectic paradox. In a sense, any number of theories concerning dialectic\nnarrative exist.\n\nIf postconstructivist theory holds, we have to choose between Foucaultist\npower relations and Lacanist obscurity. Therefore, d’Erlette[19] states that the works of Stone are modernistic.\n\nThe primary theme of the works of Rushdie is the economy, and subsequent\ncollapse, of textual sexual identity. However, if dialectic narrative holds, we\nhave to choose between neocapitalist dialectic theory and subconceptual\nfeminism.\n\nThe subject is interpolated into a Foucaultist power relations that includes\nlanguage as a whole. In a sense, Hamburger[20] suggests\nthat we have to choose between dialectic narrative and postsemantic\ndeconstructivist theory."
    num_words = len(set(re.compile(r"\.?\s+").split(test_text_1)))
    lexicon = Lexicon(1000, 8)
    rivet.deep_process_text(lexicon, test_text_1)

    assert num_words == lexicon.count()

    test_word_a = "nihilism"
    test_word_b = "denies"
    assert 1 == rivet.compare_words(lexicon, test_word_a, test_word_a)
    assert 1 != rivet.compare_words(lexicon, test_word_a, test_word_b)

    test_riv_1a = rivet.process_text(test_text_1)
    test_riv_2a = rivet.process_text(test_text_2)
    sim_a = rivet.similarity(test_riv_1a, test_riv_2a)

    assert 0 < sim_a
    assert sim_a == rivet.compare_documents(test_text_1, test_text_2)

    throwaway_lexicon = Lexicon(1000, 8)
    throwaway_lexicon.ingest(test_text_1)
    throwaway_lexicon.ingest(test_text_2)
    test_riv_1b = rivet.deep_process_text(throwaway_lexicon, test_text_1)
    test_riv_2b = rivet.deep_process_text(throwaway_lexicon, test_text_2)
    sim_b = rivet.similarity(test_riv_1b, test_riv_2b)

    lexicon = Lexicon(1000, 8)

    assert 0 < sim_b
    assert sim_b == rivet.compare_documents(test_text_1, test_text_2, lexicon=lexicon, ingest=True)

